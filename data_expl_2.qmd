---
title: "data_eplr2"
editor: visual
---

---
title: "Initial_exp"
editor: visual
---

```{r}
library(dplyr)
library(ggplot2)
week1 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w01.csv")
week2 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w02.csv")
week3 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w03.csv")
week4 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w04.csv")
week5 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w05.csv")
week6 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w06.csv")
week7 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w07.csv")
week8 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w08.csv")
week9 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w09.csv")
week10 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w10.csv")
week11 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w11.csv")
week12 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w12.csv")
week13 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w13.csv")
week14 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w14.csv")
week15 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w15.csv")
week16 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w16.csv")
week17 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w17.csv")
week18 <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/train/input_2023_w18.csv")

WideReceivers1 <- week1 %>%
  filter(player_position == "WR")
WideReceivers2 <- week2 %>%
  filter(player_position == "WR")
WideReceivers3 <- week3 %>%
  filter(player_position == "WR")
WideReceivers4 <- week4 %>%
  filter(player_position == "WR")
WideReceivers5 <- week5 %>%
  filter(player_position == "WR")
WideReceivers6 <- week6 %>%
  filter(player_position == "WR")
WideReceivers7 <- week7 %>%
  filter(player_position == "WR")
WideReceivers8 <- week8 %>%
  filter(player_position == "WR")
WideReceivers9 <- week9 %>%
  filter(player_position == "WR")
WideReceivers10 <- week10 %>%
  filter(player_position == "WR")
WideReceivers11 <- week11 %>%
  filter(player_position == "WR")
WideReceivers12 <- week12 %>%
  filter(player_position == "WR")
WideReceivers13 <- week13 %>%
  filter(player_position == "WR")
WideReceivers14 <- week14 %>%
  filter(player_position == "WR")
WideReceivers15 <- week15 %>%
  filter(player_position == "WR")
WideReceivers16 <- week16 %>%
  filter(player_position == "WR")
WideReceivers17 <- week17 %>%
  filter(player_position == "WR")
WideReceivers18 <- week18 %>%
  filter(player_position == "WR")

#View(WideReceivers)

total_distanceW1 <- WideReceivers1 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceW2 <- WideReceivers2 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW3 <- WideReceivers3 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW4 <- WideReceivers4 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW5 <- WideReceivers5 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW6 <- WideReceivers6 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW7 <- WideReceivers7 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW8 <- WideReceivers8 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW9 <- WideReceivers9 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW10 <- WideReceivers10 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW11 <- WideReceivers11 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW12 <- WideReceivers12 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW13 <- WideReceivers13 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW14 <- WideReceivers14 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW15 <- WideReceivers15 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW16 <- WideReceivers16 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW17 <- WideReceivers17 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()
total_distanceW18 <- WideReceivers18 %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceW1<- total_distanceW1 %>% mutate(group = "Week1")
total_distanceW2<- total_distanceW1 %>% mutate(group = "Week2")
total_distanceW3<- total_distanceW1 %>% mutate(group = "Week3")
total_distanceW4<- total_distanceW1 %>% mutate(group = "Week4")
total_distanceW5<- total_distanceW1 %>% mutate(group = "Week5")
total_distanceW6<- total_distanceW1 %>% mutate(group = "Week6")
total_distanceW7<- total_distanceW1 %>% mutate(group = "Week7")
total_distanceW8<- total_distanceW1 %>% mutate(group = "Week8")
total_distanceW9<- total_distanceW1 %>% mutate(group = "Week9")
total_distanceW10<- total_distanceW1 %>% mutate(group = "Week10")
total_distanceW11<- total_distanceW1 %>% mutate(group = "Week11")
total_distanceW12<- total_distanceW1 %>% mutate(group = "Week12")
total_distanceW13<- total_distanceW1 %>% mutate(group = "Week13")
total_distanceW14<- total_distanceW1 %>% mutate(group = "Week14")
total_distanceW15<- total_distanceW1 %>% mutate(group = "Week15")
total_distanceW16<- total_distanceW1 %>% mutate(group = "Week16")
total_distanceW17<- total_distanceW1 %>% mutate(group = "Week17")
total_distanceW18 <-total_distanceW18 %>% mutate(group = "Week18")

combined_distance <- bind_rows(total_distanceW1,total_distanceW2, total_distanceW3, total_distanceW4, total_distanceW5, total_distanceW6, total_distanceW7, total_distanceW8, total_distanceW9, total_distanceW10, total_distanceW11,total_distanceW12,total_distanceW13,total_distanceW14,total_distanceW15,total_distanceW16, total_distanceW17, total_distanceW18)


ggplot(combined_distance, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  facet_wrap(~group, ncol = 1, scales = "free_y") +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
sup_data <- read.csv("/Users/connorfeldman/Documents_Folder/College/MSDS/EDAV/Final_Project/114239_nfl_competition_files_published_analytics_final/supplementary_data.csv")

CLE_W4_PID <- sup_data %>%
  filter(week == 4 & (home_team_abbr == 'CLE' | visitor_team_abbr == 'CLE'))

CLE_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'CLE' | visitor_team_abbr == 'CLE'))

CLE_W4_plays <- week4 %>%
  filter(week4$play_id == CLE_W4_PID$play_id)

total_distanceCLE4 <- CLE_W4_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

CLE_W6_plays <- week6 %>%
  filter(week6$play_id == CLE_W6_PID$play_id)

total_distanceCLE6 <- CLE_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceCLE4<- total_distanceCLE4 %>% mutate(group = "PRE")
total_distanceCLE6<- total_distanceCLE6 %>% mutate(group = "POST")
CLE_Combined <- bind_rows(total_distanceCLE4, total_distanceCLE6)

ggplot(CLE_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()

```

```{r}
LAC_W4_PID <- sup_data %>%
  filter(week == 4 & (home_team_abbr == 'LAC' | visitor_team_abbr == 'LAC'))

LAC_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'LAC' | visitor_team_abbr == 'LAC'))

LAC_W4_plays <- week4 %>%
  filter(week4$play_id == LAC_W4_PID$play_id)

total_distanceLAC4 <- LAC_W4_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

LAC_W6_plays <- week6 %>%
  filter(week6$play_id == LAC_W6_PID$play_id)

total_distanceLAC6 <- LAC_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceLAC4<- total_distanceLAC4 %>% mutate(group = "PRE")
total_distanceLAC6<- total_distanceLAC6 %>% mutate(group = "POST")
LAC_Combined <- bind_rows(total_distanceLAC4, total_distanceLAC6)

ggplot(LAC_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```         
```

```{r}
SEA_W4_PID <- sup_data %>%
  filter(week == 4 & (home_team_abbr == 'SEA' | visitor_team_abbr == 'SEA'))

SEA_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'SEA' | visitor_team_abbr == 'SEA'))

SEA_W4_plays <- week4 %>%
  filter(week4$play_id == SEA_W4_PID$play_id)

total_distanceSEA4 <- SEA_W4_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

SEA_W6_plays <- week6 %>%
  filter(week6$play_id == SEA_W6_PID$play_id)

total_distanceSEA6 <- LAC_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceSEA4<- total_distanceLAC4 %>% mutate(group = "PRE")
total_distanceSEA6<- total_distanceLAC6 %>% mutate(group = "POST")
SEA_Combined <- bind_rows(total_distanceSEA4, total_distanceSEA6)

ggplot(SEA_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
TB_W4_PID <- sup_data %>%
  filter(week == 4 & (home_team_abbr == 'TB' | visitor_team_abbr == 'TB'))

TB_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'TB' | visitor_team_abbr == 'TB'))

TB_W4_plays <- week4 %>%
  filter(week4$play_id == TB_W4_PID$play_id)

total_distanceTB4 <- TB_W4_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

TB_W6_plays <- week6 %>%
  filter(week6$play_id == TB_W6_PID$play_id)

total_distanceTB6 <- TB_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceTB4<- total_distanceTB4 %>% mutate(group = "PRE")
total_distanceTB6<- total_distanceTB6 %>% mutate(group = "POST")
TB_Combined <- bind_rows(total_distanceTB4, total_distanceTB6)

ggplot(TB_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
GB_W5_PID <- sup_data %>%
  filter(week == 5 & (home_team_abbr == 'GB' | visitor_team_abbr == 'GB'))

GB_W7_PID <- sup_data %>%
  filter(week == 7 & (home_team_abbr == 'GB' | visitor_team_abbr == 'GB'))

GB_W5_plays <- week5 %>%
  filter(week5$play_id == GB_W5_PID$play_id)

total_distanceGB5 <- GB_W5_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

GB_W7_plays <- week7 %>%
  filter(week7$play_id == GB_W7_PID$play_id)

total_distanceGB7 <- GB_W7_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceGB5<- total_distanceGB5 %>% mutate(group = "PRE")
total_distanceGB7<- total_distanceGB7 %>% mutate(group = "POST")
GB_Combined <- bind_rows(total_distanceGB5, total_distanceGB7)

ggplot(GB_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
PIT_W5_PID <- sup_data %>%
  filter(week == 5 & (home_team_abbr == 'PIT' | visitor_team_abbr == 'PIT'))

PIT_W7_PID <- sup_data %>%
  filter(week == 7 & (home_team_abbr == 'PIT' | visitor_team_abbr == 'PIT'))

PIT_W5_plays <- week5 %>%
  filter(week5$play_id == PIT_W5_PID$play_id)

total_distancePIT5 <- PIT_W5_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

PIT_W7_plays <- week7 %>%
  filter(week7$play_id == PIT_W7_PID$play_id)

total_distancePIT7 <- PIT_W7_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distancePIT5<- total_distancePIT5 %>% mutate(group = "PRE")
total_distancePIT7<- total_distancePIT7 %>% mutate(group = "POST")
PIT_Combined <- bind_rows(total_distancePIT5, total_distancePIT7)

ggplot(PIT_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
CAR_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'CAR' | visitor_team_abbr == 'CAR'))

CAR_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'CAR' | visitor_team_abbr == 'CAR'))

CAR_W6_plays <- week6 %>%
  filter(week6$play_id == CAR_W6_PID$play_id)

total_distanceCAR6 <- CAR_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

CAR_W8_plays <- week8 %>%
  filter(week8$play_id == CAR_W8_PID$play_id)

total_distanceCAR8 <- CAR_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceCAR6<- total_distanceCAR6 %>% mutate(group = "PRE")
total_distanceCAR8<- total_distanceCAR8 %>% mutate(group = "POST")
CAR_Combined <- bind_rows(total_distanceCAR6, total_distanceCAR8)

ggplot(CAR_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
CIN_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'CIN' | visitor_team_abbr == 'CIN'))

CIN_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'CIN' | visitor_team_abbr == 'CIN'))

CIN_W6_plays <- week6 %>%
  filter(week6$play_id == CIN_W6_PID$play_id)

total_distanceCIN6 <- CIN_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

CIN_W8_plays <- week8 %>%
  filter(week8$play_id == CIN_W8_PID$play_id)

total_distanceCIN8 <- CIN_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceCIN6<- total_distanceCIN6 %>% mutate(group = "PRE")
total_distanceCIN8<- total_distanceCIN8 %>% mutate(group = "POST")
CIN_Combined <- bind_rows(total_distanceCIN6, total_distanceCIN8)

ggplot(CIN_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal()
```

```{r}
CIN_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'CIN' | visitor_team_abbr == 'CIN'))

CIN_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'CIN' | visitor_team_abbr == 'CIN'))

CIN_W6_plays <- week6 %>%
  filter(week6$play_id == CIN_W6_PID$play_id)

total_distanceCIN6 <- CIN_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

CIN_W8_plays <- week8 %>%
  filter(week8$play_id == CIN_W8_PID$play_id)

total_distanceCIN8 <- CIN_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceCIN6<- total_distanceCIN6 %>% mutate(group = "PRE")
total_distanceCIN8<- total_distanceCIN8 %>% mutate(group = "POST")
CIN_Combined <- bind_rows(total_distanceCIN6, total_distanceCIN8)

ggplot(CIN_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) + theme_minimal()
```

```         
```

------------------------------------------------------------------------

# Data

2.1 Technical Description:

All of the data for this project is directly provided by AWS/the NFL itself, via the Kaggle competition. However, the data is unseen by the general public and does not have any published work on it already. The data will be static for the duration of the project, with no updates.

The data can be broken down into 3 main categories:

Supplementary

This is a single csv (41 columns by 18009 rows) that provides high-level contextual data about each play from the 2023 NFL season. Every row is identified by a unique play_id, coming from each unique game within a given week 1-18. This table provides info such as pre-snap offensive formation, play outcome, pre-snap score, time of game the play happened at, as well as other relevant info. Input

This is broken down into 18 csv files (23 columns by \~30k rows each) â€“ one for each week of the season. Within each file, we have groups of rows for every player that participated in a game that week. For every player, there are multiple rows for every play they participated in, corresponding to the number of frames within that play. Output

This is also broken down into 18 csv files (6 columns by \~30k rows each), with each file again representing one week of the season. The data in this file contains the play ID, the player ID, and their final position on the field at the time the play ends.

## Description

```{r}
in_week1 <- read.csv("data/train/input_2023_w01.csv")
in_week2 <- read.csv("data/train/input_2023_w02.csv")
in_week3 <- read.csv("data/train/input_2023_w03.csv")
in_week4 <- read.csv("data/train/input_2023_w04.csv")
in_week5 <- read.csv("data/train/input_2023_w05.csv")
in_week6 <- read.csv("data/train/input_2023_w06.csv")
in_week7 <- read.csv("data/train/input_2023_w07.csv")
in_week8 <- read.csv("data/train/input_2023_w08.csv")
in_week9 <- read.csv("data/train/input_2023_w09.csv")
in_week10 <- read.csv("data/train/input_2023_w10.csv")
in_week11 <- read.csv("data/train/input_2023_w11.csv")
in_week12 <- read.csv("data/train/input_2023_w12.csv")
in_week13 <- read.csv("data/train/input_2023_w13.csv")
in_week14 <- read.csv("data/train/input_2023_w14.csv")
in_week15 <- read.csv("data/train/input_2023_w15.csv")
in_week16 <- read.csv("data/train/input_2023_w16.csv")
in_week17 <- read.csv("data/train/input_2023_w17.csv")
in_week18 <- read.csv("data/train/input_2023_w18.csv")

out_week1 <- read.csv("data/train/output_2023_w01.csv")
out_week2 <- read.csv("data/train/output_2023_w02.csv")
out_week3 <- read.csv("data/train/output_2023_w03.csv")
out_week4 <- read.csv("data/train/output_2023_w04.csv")
out_week5 <- read.csv("data/train/output_2023_w05.csv")
out_week6 <- read.csv("data/train/output_2023_w06.csv")
out_week7 <- read.csv("data/train/output_2023_w07.csv")
out_week8 <- read.csv("data/train/output_2023_w08.csv")
out_week9 <- read.csv("data/train/output_2023_w09.csv")
out_week10 <- read.csv("data/train/output_2023_w10.csv")
out_week11 <- read.csv("data/train/output_2023_w11.csv")
out_week12 <- read.csv("data/train/output_2023_w12.csv")
out_week13 <- read.csv("data/train/output_2023_w13.csv")
out_week14 <- read.csv("data/train/output_2023_w14.csv")
out_week15 <- read.csv("data/train/output_2023_w15.csv")
out_week16 <- read.csv("data/train/output_2023_w16.csv")
out_week17 <- read.csv("data/train/output_2023_w17.csv")
out_week18 <- read.csv("data/train/output_2023_w18.csv")

supplementary <- read.csv("data/supplementary_data.csv")

```

## Missing value analysis

```{r}
all_dfs <- list(file1 = in_week1, 
                file2 = in_week2, 
                file3 = in_week3, 
                file4 = in_week4, 
                file5 = in_week5, 
                file6 = in_week6, 
                file7 = in_week7, 
                file8 = in_week8, 
                file9 = in_week9, 
                file10 = in_week10, 
                file11 = in_week11, 
                file12 = in_week12, 
                file13 = in_week13, 
                file14 = in_week14, 
                file15 = in_week15, 
                file16 = in_week16, 
                file17 = in_week17, 
                file18 = in_week18, 
                file19 = out_week1, 
                file20 = out_week2, 
                file21 = out_week3, 
                file22 = out_week4, 
                file22 = out_week5, 
                file24 = out_week6, 
                file25 = out_week7, 
                file26 = out_week8, 
                file27 = out_week9, 
                file28 = out_week10, 
                file29 = out_week11, 
                file30 = out_week12, 
                file31 = out_week13, 
                file32 = out_week14, 
                file33 = out_week15, 
                file34 = out_week16, 
                file35 = out_week17, 
                file36 = out_week18, 
                file37 = supplementary
                )

library(tidyverse)

na_summary <- map_dfr(names(all_dfs), function(name) {
  df <- all_dfs[[name]]
  na_counts <- colSums(is.na(df))
  total_na <- sum(na_counts)
  
  tibble(
    dataframe = name,
    total_na = total_na,
    columns_with_na = paste(names(na_counts[na_counts > 0]), collapse = ", ")
  )
}) %>% 
  filter(total_na > 0)

na_summary


```

```{r}
DAL_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'DAL' | visitor_team_abbr == 'DAL'))

DAL_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'DAL' | visitor_team_abbr == 'DAL'))

DAL_W6_plays <- week6 %>%
  filter(play_id %in% DAL_W6_PID$play_id)

total_distanceDAL6 <- DAL_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

DAL_W8_plays <- week8 %>%
  filter(play_id %in% DAL_W8_PID$play_id)

total_distanceDAL8 <- DAL_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceDAL6<- total_distanceDAL6 %>% mutate(group = "PRE")
total_distanceDAL8<- total_distanceDAL8 %>% mutate(group = "POST")
DAL_Combined <- bind_rows(total_distanceDAL6, total_distanceDAL8)

print(ggplot(DAL_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal())
```

```{r}
HOU_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'HOU' | visitor_team_abbr == 'HOU'))

HOU_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'HOU' | visitor_team_abbr == 'HOU'))

HOU_W6_plays <- week6 %>%
  filter(play_id %in% HOU_W6_PID$play_id)

total_distanceHOU6 <- HOU_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

HOU_W8_plays <- week8 %>%
  filter(play_id %in% HOU_W8_PID$play_id)

total_distanceHOU8 <- HOU_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceHOU6<- total_distanceHOU6 %>% mutate(group = "PRE")
total_distanceHOU8<- total_distanceHOU8 %>% mutate(group = "POST")
HOU_Combined <- bind_rows(total_distanceHOU6, total_distanceHOU8)

print(ggplot(HOU_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal())
```

```{r}
NYJ_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'NYJ' | visitor_team_abbr == 'NYJ'))

NYJ_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'NYJ' | visitor_team_abbr == 'NYJ'))

NYJ_W6_plays <- week6 %>%
  filter(play_id %in% NYJ_W6_PID$play_id)

total_distanceNYJ6 <- NYJ_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

NYJ_W8_plays <- week8 %>%
  filter(play_id %in% NYJ_W8_PID$play_id)

total_distanceNYJ8 <- NYJ_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceNYJ6<- total_distanceNYJ6 %>% mutate(group = "PRE")
total_distanceNYJ8<- total_distanceNYJ8 %>% mutate(group = "POST")
NYJ_Combined <- bind_rows(total_distanceNYJ6, total_distanceNYJ8)

print(ggplot(NYJ_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal())
```

```{r}
NYJ_W6_PID <- sup_data %>%
  filter(week == 6 & (home_team_abbr == 'NYJ' | visitor_team_abbr == 'NYJ'))

NYJ_W8_PID <- sup_data %>%
  filter(week == 8 & (home_team_abbr == 'NYJ' | visitor_team_abbr == 'NYJ'))

NYJ_W6_plays <- week6 %>%
  filter(play_id %in% NYJ_W6_PID$play_id)

total_distanceNYJ6 <- NYJ_W6_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

NYJ_W8_plays <- week8 %>%
  filter(play_id %in% NYJ_W8_PID$play_id)

total_distanceNYJ8 <- NYJ_W8_plays %>%
  arrange(play_id, nfl_id, frame_id) %>% 
  group_by(play_id, nfl_id) %>%
  mutate(
    dx = x - lag(x),
    dy = y - lag(y),
    step_dist = sqrt(dx^2 + dy^2)
  ) %>%
  summarize(total_distance = sum(step_dist, na.rm = TRUE)
)%>%
  ungroup()

total_distanceNYJ6<- total_distanceNYJ6 %>% mutate(group = "PRE")
total_distanceNYJ8<- total_distanceNYJ8 %>% mutate(group = "POST")
NYJ_Combined <- bind_rows(total_distanceNYJ6, total_distanceNYJ8)

print(ggplot(NYJ_Combined, aes(x = total_distance, fill = group)) +
  geom_density(alpha = 0.6, color = NA) +
  labs(
    title = "Distribution of Player Distances by Team",
    x = "Distance (yards)",
    y = "Density"
  ) +
  theme_minimal())
```
